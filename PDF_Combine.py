import os
import re
from PyPDF2 import PdfMerger
# run pip install pypdf2
def get_first_number(filename):
    """
    Returns the first integer found in `filename`. 
    If none is found, returns 0 by default.
    """
    match = re.search(r"\d+", filename)
    if match:
        return int(match.group())
    return 0  # fallback if no integer is found

def combine_pdfs(input_folder, output_file):
    """
    Combines all PDF files from 'input_folder' into one PDF
    and saves the result in 'output_file'.
    """
    merger = PdfMerger()

    # List all PDF files in the folder
    pdf_files = [f for f in os.listdir(input_folder) if f.lower().endswith(".pdf")]
    
    # Sort the list based on the first integer in the filename
    pdf_files.sort(key=get_first_number)

    for pdf in pdf_files:
        pdf_path = os.path.join(input_folder, pdf)
        merger.append(pdf_path)

    merger.write(output_file)
    merger.close()
    print(f"Combined {len(pdf_files)} PDF(s) into {output_file}")

if __name__ == "__main__":
    # output
    folder_with_pdfs = "C:\\<filepath>\\combine me"
    output_merged_pdf = "C:\\<filepath>\\combined.pdf"
    combine_pdfs(folder_with_pdfs, output_merged_pdf)
